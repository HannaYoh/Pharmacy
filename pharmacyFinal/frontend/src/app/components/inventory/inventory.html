<div class="container">
  <div class="card">
    <div class="card-body">
      <h2 class="auth-title">Medicine Inventory</h2>
      <p class="auth-subtitle">Add or edit medicine details</p>

      <!-- ADD FORM (UNCHANGED) -->
      <form (ngSubmit)="addMedicine()" class="medicine-form">
        <label>Name</label>
        <input [(ngModel)]="newMedicine.name" name="name" required />

        <label>Generic Name</label>
        <input [(ngModel)]="newMedicine.genericname" name="genericName" />

        <label>Manufacturer</label>
        <input [(ngModel)]="newMedicine.manufacturer" name="manufacturer" />

        <label>Description</label>
        <textarea [(ngModel)]="newMedicine.description" name="description"></textarea>

        <div class="actions">
          <button class="btn primary" type="submit">Add Medicine</button>
        </div>
      </form>

      <!-- CURRENT MEDICINES TABLE -->
      <div style="margin-top: 16px">
        <h3 style="margin: 0 0 8px">Current Medicines</h3>
        <div class="medicine-list">
          <!-- TABLE HEADER -->
          <div
            style="
              display: grid;
              grid-template-columns: 2fr 1fr 1fr 1fr;
              gap: 12px;
              font-weight: 600;
              padding: 10px 0;
            "
          >
            <div>Name</div>
            <div>Generic</div>
            <div>Manufacturer</div>
            <div>Actions</div>
          </div>

          <!-- MEDICINE ROWS -->
          <div
            *ngFor="let med of medicines; let idx = index"
            style="
              display: grid;
              grid-template-columns: 2fr 1fr 1fr 1fr;
              gap: 12px;
              align-items: center;
              padding: 10px 0;
              border-top: 1px solid var(--border);
            "
          >
            <div style="line-height: 1.4">
              <strong>{{ med.name }}</strong
              ><br />
              <small style="color: var(--text-secondary)">{{ med.description || '-' }}</small>
            </div>

            <div>{{ med.genericname || '-' }}</div>
            <div>{{ med.manufacturer || '-' }}</div>

            <div>
              <button class="btn" (click)="startEdit(idx)">Edit</button>
              <button class="btn" style="margin-left: 8px" (click)="deleteMedicine(med.id!)">
                Delete
              </button>
            </div>
          </div>
          <!-- EDIT FORM (INLINE) -->
          <div
            *ngIf="editIndex !== null"
            style="border-top: 1px solid var(--border); margin-top: 8px; padding-top: 8px"
          >
            <h4 style="margin: 0 0 8px">Edit Medicine</h4>
            <form (ngSubmit)="updateMedicine()">
              <label>Name</label>
              <input [(ngModel)]="editMedicine.name" name="edit_name" required />

              <label>Generic Name</label>
              <input [(ngModel)]="editMedicine.genericname" name="edit_genericName" />

              <label>Manufacturer</label>
              <input [(ngModel)]="editMedicine.manufacturer" name="edit_manufacturer" />

              <label>Description</label>
              <textarea [(ngModel)]="editMedicine.description" name="edit_description"></textarea>

              <div class="actions" style="margin-top: 8px">
                <button class="btn primary" type="submit">Save Changes</button>
                <button class="btn" type="button" style="margin-left: 8px" (click)="cancelEdit()">
                  Cancel
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
